<?xml version="1.0"?>
<sdf version="1.10">
  <model name="my_tiltwing">
    <pose>0 0 0 0 0 0</pose>
    <link name="base_link">
      <inertial>
        <mass>5.0</mass>
        <inertia>
          <ixx>0.1</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.1</iyy><iyz>0</iyz>
          <izz>0.1</izz>
        </inertia>
      </inertial>
      <visual name="fuselage_visual">
        <geometry><box><size>1.5 0.3 0.2</size></box></geometry>
        <material><diffuse>0.8 0.2 0.2 1</diffuse></material>
      </visual>
      <collision name="fuselage_collision">
        <geometry><box><size>1.5 0.3 0.2</size></box></geometry>
      </collision>
    </link>
    <joint name="wing_tilt_joint" type="revolute">
      <parent>base_link</parent>
      <child>wing_link</child>
      <pose>0 0 0.1 0 0 0</pose>
      <axis>
        <xyz>0 1 0</xyz>
        <limit><lower>-1.57</lower><upper>0</upper></limit>
      </axis>
    </joint>
    <link name="wing_link">
      <inertial>
        <mass>1.0</mass>
        <inertia>
          <ixx>0.05</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.05</iyy><iyz>0</iyz>
          <izz>0.05</izz>
        </inertia>
      </inertial>
      <visual name="wing_visual">
        <geometry><box><size>0.1 2 0.05</size></box></geometry>
        <material><diffuse>0.2 0.8 0.2 1</diffuse></material>
      </visual>
      <collision name="wing_collision">
        <geometry><box><size>0.1 2 0.05</size></box></geometry>
      </collision>
    </link>
    <link name="prop1_link">
      <pose>0 0.5 0 0 0 0</pose>
      <inertial>
        <mass>0.1</mass>
        <inertia><ixx>0.001</ixx><iyy>0.001</iyy><izz>0.001</izz></inertia>
      </inertial>
      <visual name="prop1_visual">
        <geometry><cylinder><radius>0.1</radius><length>0.02</length></cylinder></geometry>
        <material><diffuse>0.2 0.2 0.8 1</diffuse></material>
      </visual>
      <collision name="prop1_collision">
        <geometry><cylinder><radius>0.1</radius><length>0.02</length></cylinder></geometry>
      </collision>
    </link>
    <joint name="prop1_joint" type="revolute">
      <parent>wing_link</parent>
      <child>prop1_link</child>
      <axis><xyz>0 0 1</xyz></axis>
    </joint>
    <plugin name="motor1" filename="libgz-sim-motor-model-system.so">
      <jointName>prop1_joint</jointName>
      <turnDirection>ccw</turnDirection>
      <motorConstant>0.01</motorConstant>
      <commandTopic>motor1/command</commandTopic>
    </plugin>
    <link name="prop2_link">
      <pose>0 -0.5 0 0 0 0</pose>
      <inertial>
        <mass>0.1</mass>
        <inertia><ixx>0.001</ixx><iyy>0.001</iyy><izz>0.001</izz></inertia>
      </inertial>
      <visual name="prop2_visual">
        <geometry><cylinder><radius>0.1</radius><length>0.02</length></cylinder></geometry>
        <material><diffuse>0.2 0.2 0.8 1</diffuse></material>
      </visual>
      <collision name="prop2_collision">
        <geometry><cylinder><radius>0.1</radius><length>0.02</length></cylinder></geometry>
      </collision>
    </link>
    <joint name="prop2_joint" type="revolute">
      <parent>wing_link</parent>
      <child>prop2_link</child>
      <axis><xyz>0 0 1</xyz></axis>
    </joint>
    <plugin name="motor2" filename="libgz-sim-motor-model-system.so">
      <jointName>prop2_joint</jointName>
      <turnDirection>cw</turnDirection>
      <motorConstant>0.01</motorConstant>
      <commandTopic>motor2/command</commandTopic>
    </plugin>
    <link name="imu_link">
      <pose>0 0 0 0 0 0</pose>
      <sensor name="imu_sensor" type="imu">
        <plugin name="imu_plugin" filename="libgz-sim-imu-system.so"/>
      </sensor>
    </link>
    <plugin name="lift_drag" filename="libgz-sim-lift-drag-system.so">
      <a0>0.1</a0>
      <cla>0.1</cla>
      <cla_stall>-0.5</cla_stall>
      <alpha_stall>0.4</alpha_stall>
    </plugin>
    <plugin name="ardupilot_plugin" filename="libArduPilotPlugin.so">
      <modelName>my_tiltwing</modelName>
      <fdm_addr>127.0.0.1</fdm_addr>
      <fdm_port_in>9002</fdm_port_in>
      <fdm_port_out>9003</fdm_port_out>
      <imuName>imu_link/imu_sensor</imuName>
      <control channel="0">
        <type>ATTITUDE</type>
        <jointName>wing_tilt_joint</jointName>
        <multiplier>1</multiplier>
        <controlID>0</controlID>
      </control>
    </plugin>
  </model>
</sdf>